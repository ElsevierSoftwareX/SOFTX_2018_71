<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transformations Benchmark • rsppfp</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Transformations Benchmark">
<meta property="og:description" content="">
<meta property="og:image" content="http://melvidoni.github.io/rsppfp/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rsppfp</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/rsppfp.html">rsppfp Details</a>
    </li>
    <li>
      <a href="../articles/benchmark.html">Transformations Benchmark</a>
    </li>
    <li>
      <a href="../articles/igraph.html">Example: igraph Integration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/references.html">References</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/melvidoni/rsppfp">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/melvidoni/rsppfp">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Transformations Benchmark</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/melvidoni/rsppfp/blob/master/vignettes/benchmark.Rmd"><code>vignettes/benchmark.Rmd</code></a></small>
      <div class="hidden name"><code>benchmark.Rmd</code></div>

    </div>

    
    
<div id="random-graphs-generation" class="section level2">
<h2 class="hasAnchor">
<a href="#random-graphs-generation" class="anchor"></a>Random Graphs Generation</h2>
<p>To evaluate <strong>rsppfp package</strong>, several examples were benchmarked. This is run using 27 randomly generated graphs, which result from the combination of the following values:</p>
<ul>
<li>A set of nodes of sizes: <code>size(N) = {100, 300, 500}</code>
</li>
<li>The number of forbidden paths varying according to <code>size(F) = {50, 250, 500}</code>
</li>
<li>A varying densite of <code>size(d) = {0.1, 0.5, 0.9}</code>
</li>
</ul>
<p>A total of 27 graphs were generated using igraph’s <code>erdos.renyi.game(...)</code>, and the forbidden paths were constructed with their <code>random_walk(…)</code> function; results were limited to prevent walks of less than three nodes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Checks if the path is part of any row of the forbidden subpaths.</span>
<span class="co"># Returns the logical comparison of the evaluation.</span>
already_exists &lt;-<span class="st"> </span><span class="cf">function</span>(fp, path) {
  <span class="kw">return</span>( <span class="kw">any</span>( 
    <span class="kw">apply</span>(fp, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">str_detect</span>(<span class="kw">paste</span>(x, <span class="dt">collapse=</span><span class="st">","</span>), <span class="kw">paste</span>(path, <span class="dt">collapse=</span><span class="st">","</span>))) 
  ))
}


<span class="co"># Checks if a forbidden paths contains a subpath of another forbidden path.</span>
<span class="co"># Returns the logical result of the comparison.</span>
has_subpath &lt;-<span class="st"> </span><span class="cf">function</span>(fp, path) {
  <span class="co"># If the length if 3, evaluate as-is</span>
  <span class="cf">if</span>(<span class="kw">length</span>(path) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) {
    <span class="kw">return</span>(<span class="kw">already_exists</span>(fp, path))
  }
  <span class="co"># Otherwise</span>
  <span class="cf">else</span> {
    <span class="co"># We need to generate subpaths of length three</span>
    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(path) <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)) {
      <span class="co"># Check if the value is a subpath. If it is, return immediately</span>
      <span class="cf">if</span>( <span class="kw">already_exists</span>(fp, path[i<span class="op">:</span>(i<span class="op">+</span><span class="dv">2</span>)]) ) <span class="kw">return</span>(<span class="ot">TRUE</span>)
    }
    
    <span class="co"># If we got here, return false</span>
    <span class="kw">return</span>(<span class="ot">FALSE</span>)
  }
}


<span class="co"># Creates random graphs using a specific seed.</span>
<span class="co"># seed &lt;- 1111</span>
get_random_graphs &lt;-<span class="st"> </span><span class="cf">function</span>(seed, directory) {
  <span class="co"># Set a random seed</span>
  <span class="kw">set.seed</span>(seed)
  
  <span class="co"># Prepare values</span>
  nodesNumbers &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">300</span>, <span class="dv">500</span>)
  densities &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>)
  fpathsNumber &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">250</span>, <span class="dv">500</span>)
  
  
  <span class="co"># Create the dataframe</span>
  graphsInfo &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
    <span class="dt">nCount =</span> <span class="kw">numeric</span>(),
    <span class="dt">nCountReal =</span> <span class="kw">numeric</span>(),
    <span class="dt">aCount =</span> <span class="kw">numeric</span>(),
    <span class="dt">density =</span> <span class="kw">numeric</span>(),
    <span class="dt">fCountTheoric =</span> <span class="kw">numeric</span>(),
    <span class="dt">fCountReal =</span> <span class="kw">numeric</span>(), 
    <span class="dt">gfile =</span> <span class="kw">character</span>(),
    <span class="dt">fFile =</span> <span class="kw">character</span>(),
    <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>
  )
  
  
  <span class="co"># Loop through the node count</span>
  <span class="cf">for</span>(nodeCount <span class="cf">in</span> nodesNumbers) {
    
    <span class="co"># Loop through the density</span>
    <span class="cf">for</span>(d <span class="cf">in</span> densities) {
      <span class="co"># Get the arc count</span>
      arcsNumber &lt;-<span class="st"> </span>(nodeCount <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>d
      
      <span class="co"># Create a graph</span>
      graphI &lt;-<span class="st"> </span><span class="kw">erdos.renyi.game</span>(nodeCount, arcsNumber, <span class="dt">directed =</span> <span class="ot">TRUE</span>, <span class="dt">type =</span> <span class="st">"gnm"</span>)
      
      <span class="co"># Remove nodes without edges</span>
      graphI &lt;-<span class="st"> </span><span class="kw">delete_vertices</span>(graphI, <span class="kw">V</span>(graphI)[ <span class="kw">degree</span>(graphI, <span class="dt">v =</span> <span class="kw">V</span>(graphI), <span class="dt">mode =</span> <span class="st">"total"</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])
      giDF &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">get.edgelist</span>(graphI)) <span class="op">%&gt;%</span><span class="st"> `</span><span class="dt">colnames&lt;-</span><span class="st">`</span>(<span class="kw">c</span>(<span class="st">"from"</span>, <span class="st">"to"</span>))
      
      <span class="co"># Loop on the number of forbidden paths</span>
      <span class="cf">for</span>(fpCount <span class="cf">in</span> fpathsNumber) {
        
        <span class="co"># Get the starting nodes for forbidden paths</span>
        randomStartNodes &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x =</span> <span class="kw">V</span>(graphI), <span class="dt">size =</span> fpCount, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
        fpDF &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">6</span>, <span class="dt">nrow =</span> <span class="dv">0</span>))
        
        <span class="co"># For each element there</span>
        <span class="cf">for</span>(rsn <span class="cf">in</span> randomStartNodes) {
          
          <span class="co"># Get a random number of steps</span>
          rSteps &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">1</span>)
          
          <span class="co"># Create a random walk through the graph</span>
          rWalk &lt;-<span class="st"> </span><span class="kw">random_walk</span>(<span class="dt">graph =</span> graphI, <span class="dt">start =</span> rsn, <span class="dt">steps =</span> rSteps, 
                               <span class="dt">mode =</span> <span class="st">"out"</span>, <span class="dt">stuck =</span> <span class="st">"return"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.vector</span>()
          
          <span class="co"># If it is at least 3 nodes long and has no subpaths</span>
          <span class="cf">if</span>(<span class="kw">length</span>(rWalk) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">has_subpath</span>(fpDF, rWalk) ) {
            <span class="co"># Then add it to the list</span>
            fpDF[<span class="kw">nrow</span>(fpDF) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, ] &lt;-<span class="st"> </span><span class="kw">structure</span>(<span class="st">"length&lt;-"</span>(rWalk, <span class="dv">6</span>), <span class="dt">class =</span> <span class="kw">class</span>(rWalk)) 
          }
        }
        
        <span class="co"># Record the files</span>
        gFileName &lt;-<span class="st"> </span><span class="kw">paste0</span>(directory, <span class="st">"/"</span>, nodeCount, <span class="st">"Graph_"</span>, (d <span class="op">*</span><span class="st"> </span><span class="dv">100</span>), <span class="st">"pDense_"</span>, fpCount, <span class="st">"fp_Graph.csv"</span>, 
                            <span class="dt">collapse =</span> <span class="st">""</span>)
        fFileName &lt;-<span class="st"> </span><span class="kw">paste0</span>(directory, <span class="st">"/"</span>, nodeCount, <span class="st">"Graph_"</span>, (d <span class="op">*</span><span class="st"> </span><span class="dv">100</span>), <span class="st">"pDense_"</span>, fpCount, <span class="st">"fp_Paths.csv"</span>, 
                            <span class="dt">collapse =</span> <span class="st">""</span>)
        <span class="kw">write.csv</span>(<span class="dt">file =</span> gFileName, <span class="dt">x =</span> giDF, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)
        <span class="kw">write.table</span>(fpDF, fFileName, <span class="dt">na =</span> <span class="st">""</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">col.names =</span> <span class="ot">FALSE</span>, <span class="dt">append =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">","</span>)
        
        <span class="co"># Append to the dataframe</span>
        graphsInfo[<span class="kw">nrow</span>(graphsInfo) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, ] &lt;-<span class="st"> </span>
<span class="st">          </span><span class="kw">list</span>(nodeCount, <span class="kw">length</span>(<span class="kw">V</span>(graphI)), arcsNumber, d, fpCount, <span class="kw">nrow</span>(fpDF), gFileName, fFileName)
      }
    } <span class="co"># End densities loop</span>
  } <span class="co"># End arc count loop</span>

  
  <span class="co"># Return the values</span>
  <span class="kw">return</span>(graphsInfo)
}</code></pre></div>
</div>
<div id="benchmark-results" class="section level2">
<h2 class="hasAnchor">
<a href="#benchmark-results" class="anchor"></a>Benchmark Results</h2>
<p>Figure 1 shows the results for digraphs of each density. This was executed on a computer with an Intel I7-4790 CPU at 3.6Ghz, with 4GB of RAM, using Linux Ubuntu 16.04 as the operating system. Three cores out of four were used in all of the transformations.</p>
<p><img src="benchmark_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>As can be seen, in all situations the more general algorithm (Hsu’s) takes longer to complete, though this difference increases with the number of forbidden paths and density. It is worth mentioning that this is expected behavior, as the transformation logic iterates on the forbidden paths <code>F</code> –each one needs to be individually evaluated to add new nodes and arcs to the graph. Because of its logic, Hsu’s backward construction always produces a smaller <code>gStar</code> with less nodes and arcs, while Villeneuve’s algorithm is slightly faster; this difference is noticeable for larger values of <code>F</code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#random-graphs-generation">Random Graphs Generation</a></li>
      <li><a href="#benchmark-results">Benchmark Results</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Melina Vidoni, Aldo Vecchietti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
